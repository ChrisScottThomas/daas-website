---
import Base from "../layouts/base.astro";
import Modal from "../components/Modal.astro";
import BarChart from "../components/BarChart.jsx";
---

<Base title="Support Plans — Clarity.">
  <main class="max-w-5xl mx-auto px-4 py-24 text-center">
    <h1 class="text-5xl font-bold mb-4 leading-tight">Support Plans</h1>
    <p class="text-xl text-gray-600 dark:text-gray-300 mb-12">
      Simple, strategic support — at the pace that suits you.
    </p>

    <!-- Microcopy + Toggle -->
    <div x-data="{ billing: 'monthly' }">
      <!-- Toggle -->
      <div class="mb-6 flex flex-col items-center">
        <div class="flex justify-center gap-2 mb-2">
          <button
            :class="billing === 'monthly' ? 'bg-black text-white' : 'bg-gray-200 dark:bg-gray-700 dark:text-white'"
            @click="billing = 'monthly'"
            class="px-4 py-2 rounded-l font-medium"
          >
            Monthly
          </button>
          <button
            :class="billing === 'quarterly' ? 'bg-black text-white' : 'bg-gray-200 dark:bg-gray-700 dark:text-white'"
            @click="billing = 'quarterly'"
            class="px-4 py-2 font-medium"
          >
            Quarterly
          </button>
          <button
            :class="billing === 'annually' ? 'bg-black text-white' : 'bg-gray-200 dark:bg-gray-700 dark:text-white'"
            @click="billing = 'annually'"
            class="px-4 py-2 rounded-r font-medium"
          >
            Annually
          </button>
        </div>
        <p class="text-sm text-gray-500 dark:text-gray-400">
          Annual pricing: Get 12 months for the price of 11
        </p>
      </div>

      <!-- Plans Grid -->
      <div
        id="support-plans"
        class="grid grid-cols-1 md:grid-cols-3 gap-6 items-stretch"
      >
        <!-- Clarity. Base -->
        <div
          class="flex flex-col h-full border border-gray-300 dark:border-gray-600 rounded-lg p-6 text-left shadow-sm bg-white dark:bg-gray-900"
        >
          <h2 class="text-2xl font-bold mb-2">Clarity. Base</h2>
          <p class="text-gray-600 dark:text-gray-400 mb-4">
            Responsive, low-friction support focused on a single team or
            initiative. Often used to accelerate product decisions, unblock
            delivery, or sharpen direction without spinning up a project.
          </p>
          <!-- Annual -->
          <div x-show="billing === 'annually'" class="mb-4">
            <p class="text-3xl font-extrabold">
              £54,989
              <span class="text-base text-gray-500 line-through ml-2"
                >£59,988</span
              >
            </p>
            <p x-show="billing === 'annually'" class="text-sm text-blue-400">
              Save £4,999 annually
            </p>
          </div>

          <!-- Quarterly -->
          <p
            x-show="billing === 'quarterly'"
            class="text-3xl font-extrabold mb-4"
          >
            £14,997
          </p>

          <!-- Monthly -->
          <p
            x-show="billing === 'monthly'"
            class="text-3xl font-extrabold mb-4"
          >
            £4,999
          </p>

          <ul
            class="flex-1 list-disc list-outside pl-6 space-y-2 text-left text-gray-700 dark:text-gray-300"
          >
            <li>Lightweight, always-on support for one focus area</li>
            <li>Quick-turn input that feels embedded, not external</li>
            <li>Clear thinking when the next step isn't obvious</li>
          </ul>
          <div class="mt-6 text-center">
            <a
              href="#waitlist"
              class="inline-block bg-black text-white px-4 py-2 rounded hover:bg-gray-800 transition text-center"
              >Join Waitlist</a
            >
          </div>
        </div>

        <!-- Clarity. Plus -->
        <div
          class="flex flex-col h-full border border-gray-300 dark:border-gray-600 rounded-lg p-6 text-left shadow-sm bg-white dark:bg-gray-900"
        >
          <h2 class="text-2xl font-bold mb-2">Clarity. Plus</h2>
          <p class="text-gray-600 dark:text-gray-400 mb-4">
            Trusted support across multiple teams or workstreams. Ideal when
            strategic clarity needs to scale, but you still want things to feel
            fast, familiar, and close to the work.
          </p>
          <!-- Annual -->
          <div x-show="billing === 'annually'" class="mb-4">
            <p class="text-3xl font-extrabold">
              £109,989
              <span class="text-base text-gray-500 line-through ml-2"
                >£119,988</span
              >
            </p>
            <p x-show="billing === 'annually'" class="text-sm text-blue-400">
              Save £9,999 annually
            </p>
          </div>
          <p
            x-show="billing === 'quarterly'"
            class="text-3xl font-extrabold mb-4"
          >
            £29,997
          </p>
          <p
            x-show="billing === 'monthly'"
            class="text-3xl font-extrabold mb-4"
          >
            £9,999
          </p>

          <ul
            class="flex-1 list-disc list-outside pl-6 space-y-2 text-left text-gray-700 dark:text-gray-300"
          >
            <li>Context-aware input across multiple decision points</li>
            <li>Regular rhythm of sessions, insight, and briefings</li>
            <li>Strategy stays joined-up even as priorities shift</li>
          </ul>
          <div class="mt-6 text-center">
            <a
              href="#waitlist"
              class="inline-block bg-black text-white px-4 py-2 rounded hover:bg-gray-800 transition"
              >Join Waitlist</a
            >
          </div>
        </div>

        <!-- Clarity. Partner -->
        <div
          class="flex flex-col h-full border border-gray-300 dark:border-gray-600 rounded-lg p-6 text-left shadow-sm bg-white dark:bg-gray-900"
        >
          <h2 class="text-2xl font-bold mb-2">Clarity. Partner</h2>
          <p class="text-gray-600 dark:text-gray-400 mb-4">
            Strategic partnership embedded at the leadership level. Designed for
            clients navigating complex change, competing priorities, or
            high-stakes decision-making across a portfolio.
          </p>
          <!-- Annual -->
          <div x-show="billing === 'annually'" class="mb-4">
            <p class="text-3xl font-extrabold">
              £131,989
              <span class="text-base text-gray-500 line-through ml-2"
                >£143,988</span
              >
            </p>
            <p x-show="billing === 'annually'" class="text-sm text-blue-400">
              Save £11,999 annually
            </p>
          </div>
          <p
            x-show="billing === 'quarterly'"
            class="text-3xl font-extrabold mb-4"
          >
            £35,997
          </p>
          <p
            x-show="billing === 'monthly'"
            class="text-3xl font-extrabold mb-4"
          >
            £11,999
          </p>

          <ul
            class="flex-1 list-disc list-outside pl-6 space-y-2 text-left text-gray-700 dark:text-gray-300"
          >
            <li>Clarity. lead embedded across your leadership rhythm</li>
            <li>Proactive thinking, not just reactive input</li>
            <li>Decisions feel coordinated, timely, and confident</li>
          </ul>
          <div class="mt-6 text-center">
            <a
              href="#waitlist"
              class="inline-block bg-black text-white px-4 py-2 rounded hover:bg-gray-800 transition"
              >Join Waitlist</a
            >
          </div>
        </div>
      </div>
    </div>

    <section class="mt-20 max-w-5xl mx-auto px-4 text-center mb-12">
      <h2 class="text-3xl font-bold mb-10">Compare the Plans</h2>

      <div
        id="compare-plans"
        class="flex-1 grid grid-cols-1 md:grid-cols-3 gap-6 items-stretch text-left"
      >
        <!-- Base Plan -->
        <div
          class="flex flex-col h-full border border-gray-300 dark:border-gray-600 rounded-lg p-6 text-left shadow-sm bg-white dark:bg-gray-900"
        >
          <h2 class="text-2xl font-bold mb-2">Clarity. Base</h2>
          <ul
            class="flex-1 list-disc list-outside pl-6 space-y-2 text-left text-gray-700
          dark:text-gray-300"
          >
            <li><strong>Best for:</strong> A single delivery team</li>
            <li><strong>Presence:</strong> Named lead, async input</li>
            <li><strong>Sessions:</strong> Fortnightly (optional)</li>
            <li><strong>Briefs:</strong> Around 1 per month</li>
            <li><strong>Radar:</strong> Available on request</li>
            <li><strong>In-person:</strong> Remote only</li>
            <li><strong>Outcome:</strong> Unblocked delivery, sharper focus</li>
          </ul>
        </div>

        <!-- Plus Plan -->
        <div
          class="flex flex-col h-full border border-gray-300 dark:border-gray-600 rounded-lg p-6 text-left shadow-sm bg-white dark:bg-gray-900"
        >
          <!-- <span
            class="absolute top-4 right-4 px-2 py-1 text-xs font-semibold bg-[#EF5974] text-white rounded"
          >
            Most chosen
          </span> -->
          <h2 class="text-2xl font-bold mb-2">Clarity. Plus</h2>
          <ul
            class="flex-1 list-disc list-outside pl-6 space-y-2 text-left text-gray-700
          dark:text-gray-300"
          >
            <li><strong>Best for:</strong> Multi-team initiatives</li>
            <li><strong>Presence:</strong> Multi-stakeholder engagement</li>
            <li><strong>Sessions:</strong> Weekly</li>
            <li><strong>Briefs:</strong> 2-3 per month</li>
            <li><strong>Radar:</strong> Included</li>
            <li><strong>In-person:</strong> Optional by request</li>
            <li>
              <strong>Outcome:</strong> Joined-up strategy, aligned momentum
            </li>
          </ul>
        </div>

        <!-- Partner Plan -->
        <div
          class="flex flex-col h-full border border-gray-300 dark:border-gray-600 rounded-lg p-6 text-left shadow-sm bg-white dark:bg-gray-900"
        >
          <h2 class="text-2xl font-bold mb-2">Clarity. Partner</h2>
          <ul
            class="flex-1 list-disc list-outside pl-6 space-y-2 text-left text-gray-700
          dark:text-gray-300"
          >
            <li>
              <strong>Best for:</strong> Executive-level support or portfolios
            </li>
            <li>
              <strong>Presence:</strong> Strategic partner across leadership
            </li>
            <li><strong>Sessions:</strong> Weekly or as needed</li>
            <li><strong>Briefs:</strong> As required, tailored to audience</li>
            <li><strong>Radar:</strong> Included with watchlist</li>
            <li><strong>In-person:</strong> Optional by request</li>
            <li>
              <strong>Outcome:</strong> Confident, joined-up decision-making
            </li>
          </ul>
        </div>
      </div>
    </section>

    <section class="mt-20 max-w-5xl mx-auto px-4 text-center mb-12">
      <h2 class="text-3xl font-bold mb-6" id="clarityRateChart">
        Clarity. vs. Traditional Consultancy
      </h2>
      <p class="text-xl text-gray-600 dark:text-gray-300 mb-4">
        Compare average daily costs and see how Clarity. stacks up.
      </p>

      <BarChart client:only="react" />

      <p class="text-sm text-gray-500 dark:text-gray-400 mt-4">
        Data from: ITJobsWatch, Malt, LinkedIn. Clarity. daily rates assume 22
        working days/month.
      </p>
    </section>

    <section class="mt-20 flex flex-col mx-auto px-4 py-10 max-w-5xl mb-12">
      <h2 class="text-3xl font-bold mb-6">
        Not sure which plan is right for you?
      </h2>
      <p class="mb-4">
        Answer a few quick questions to help guide your choice.
      </p>

      <form
        id="planQuiz"
        class="flex flex-col mx-auto space-y-8 bg-white dark:bg-gray-900 p-6 rounded-2xl shadow-md"
      >
        <!-- Question 1 -->
        <fieldset>
          <legend class="block text-left font-semibold mb-3"
            >1. How many teams or workstreams do you want support across?</legend
          >
          <div class="space-y-2">
            <label
              class="flex justify-start items-center gap-3 bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-xl px-4 py-2 cursor-pointer transition"
            >
              <input
                type="radio"
                name="q1"
                value="A"
                required
                class="accent-[#EF5974]"
              />
              <span class="text-base">Just one team</span>
            </label>
            <label
              class="flex justify-start items-center gap-3 bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-xl px-4 py-2 cursor-pointer transition"
            >
              <input
                type="radio"
                name="q1"
                value="B"
                class="accent-[#EF5974]"
              />
              <span class="text-base"
                >A few related teams or a strategic area</span
              >
            </label>
            <label
              class="flex justify-start items-center gap-3 bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-xl px-4 py-2 cursor-pointer transition"
            >
              <input
                type="radio"
                name="q1"
                value="C"
                class="accent-[#EF5974]"
              />
              <span class="text-base"
                >Multiple teams, execs, or shifting priorities</span
              >
            </label>
          </div>
        </fieldset>

        <!-- Question 2 -->
        <fieldset>
          <legend class="block text-left font-semibold mb-3"
            >2. What kind of support are you looking for?</legend
          >
          <div class="space-y-2">
            <label
              class="flex justify-start items-center gap-3 bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-xl px-4 py-2 cursor-pointer transition"
            >
              <input
                type="radio"
                name="q2"
                value="A"
                required
                class="accent-[#EF5974]"
              />
              <span class="text-base"
                >A thought partner for product/delivery</span
              >
            </label>
            <label
              class="flex justify-start items-center gap-3 bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-xl px-4 py-2 cursor-pointer transition"
            >
              <input
                type="radio"
                name="q2"
                value="B"
                class="accent-[#EF5974]"
              />
              <span class="text-base">A lens across multiple squads</span>
            </label>
            <label
              class="flex justify-start items-center gap-3 bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-xl px-4 py-2 cursor-pointer transition"
            >
              <input
                type="radio"
                name="q2"
                value="C"
                class="accent-[#EF5974]"
              />
              <span class="text-base"
                >Strategic presence at leadership level</span
              >
            </label>
          </div>
        </fieldset>

        <!-- Question 3 -->
        <fieldset>
          <legend class="block text-left font-semibold mb-3"
            >3. How often do you want input from Clarity.?</legend
          >
          <div class="space-y-2">
            <label
              class="flex justify-start items-center gap-3 bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-xl px-4 py-2 cursor-pointer transition"
            >
              <input
                type="radio"
                name="q3"
                value="A"
                required
                class="accent-[#EF5974]"
              />
              <span class="text-base">A couple of times a month</span>
            </label>
            <label
              class="flex justify-start items-center gap-3 bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-xl px-4 py-2 cursor-pointer transition"
            >
              <input
                type="radio"
                name="q3"
                value="B"
                class="accent-[#EF5974]"
              />
              <span class="text-base">Weekly</span>
            </label>
            <label
              class="flex justify-start items-center gap-3 bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-xl px-4 py-2 cursor-pointer transition"
            >
              <input
                type="radio"
                name="q3"
                value="C"
                class="accent-[#EF5974]"
              />
              <span class="text-base">Frequently - sessions, briefs, radar</span
              >
            </label>
          </div>
        </fieldset>

        <!-- Question 4 -->
        <fieldset>
          <legend class="block text-left font-semibold mb-3"
            >4. Who will we be working with day-to-day?</legend
          >
          <div class="space-y-2">
            <label
              class="flex justify-start items-center gap-3 bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-xl px-4 py-2 cursor-pointer transition"
            >
              <input
                type="radio"
                name="q4"
                value="A"
                required
                class="accent-[#EF5974]"
              />
              <span class="text-base">Product Owner / Team Lead</span>
            </label>
            <label
              class="flex justify-start items-center gap-3 bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-xl px-4 py-2 cursor-pointer transition"
            >
              <input
                type="radio"
                name="q4"
                value="B"
                class="accent-[#EF5974]"
              />
              <span class="text-base">Heads of Product / Tech</span>
            </label>
            <label
              class="flex justify-start items-center gap-3 bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-xl px-4 py-2 cursor-pointer transition"
            >
              <input
                type="radio"
                name="q4"
                value="C"
                class="accent-[#EF5974]"
              />
              <span class="text-base">Director / CPO / Exec Team</span>
            </label>
          </div>
        </fieldset>

        <!-- Submit -->
        <button
          type="submit"
          class="bg-[#EF5974] text-white font-bold px-6 py-2 rounded-xl hover:bg-[#e1526f] transition"
        >
          Show My Match
        </button>
      </form>
    </section>

    <Modal id="quizResultModal">
      <div id="quizResultContent"></div>
    </Modal>

    <script type="text/javascript">
      const form = document.getElementById("planQuiz");
      const resultModal = document.getElementById("quizResultModal");
      const modalContent = document.getElementById("quizResultContent");

      form.addEventListener("submit", function (e) {
        e.preventDefault();
        const formData = new FormData(form);
        const counts = { A: 0, B: 0, C: 0 };

        for (const [, value] of formData.entries()) {
          counts[value]++;
        }

        const max = Object.entries(counts).reduce((a, b) =>
          a[1] > b[1] ? a : b,
        );
        const planMap = {
          A: `<strong>Base Plan:</strong> Best for focused support with a single delivery team.`,
          B: `<strong>Plus Plan:</strong> Ideal for multi-team strategy and alignment.`,
          C: `<strong>Partner Plan:</strong> Built for execs and portfolios needing confident, joined-up decisions.`,
        };

        modalContent.innerHTML = `
  <div class="text-center">
    <h3 class="text-2xl font-bold mb-2">Your Match</h3>
    <p class="mb-4">${planMap[max[0]]}</p>
    <a
      href="#support-plans"
      id="viewPlanDetailsLink"
      class="inline-block mt-2 px-4 py-2 rounded-xl bg-[#EF5974] text-white font-semibold hover:bg-[#e1526f] transition"
    >
      View Plan Details
    </a>
  </div>
`;

        document
          .getElementById("viewPlanDetailsLink")
          .addEventListener("click", () => {
            // Delay modal close slightly to allow anchor jump
            setTimeout(() => {
              resultModal.classList.add("hidden");
              document.body.style.overflow = "";
            }, 100); // 100ms gives time for scroll to occur
          });

        resultModal.classList.remove("hidden");
        document.body.style.overflow = "hidden";
      });

      window.addEventListener("keydown", (e) => {
        if (e.key === "Escape") {
          document.getElementById("quizResultModal").classList.add("hidden");
          document.body.style.overflow = "";
        }
      });

      document.addEventListener("click", (e) => {
        if (e.target.id === "quizResultModal") {
          resultModal.classList.add("hidden");
          document.body.style.overflow = "";
        }
      });
    </script>

    <!-- AlpineJS for toggling -->
    <script
      src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"
      defer></script>
  </main>
</Base>
